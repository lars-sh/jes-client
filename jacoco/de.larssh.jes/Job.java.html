<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Job.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JES Client</a> &gt; <a href="index.source.html" class="el_package">de.larssh.jes</a> &gt; <span class="el_source">Job.java</span></div><h1>Job.java</h1><pre class="source lang-java linenums">// Generated by delombok at Wed Sep 06 17:22:20 UTC 2023
package de.larssh.jes;

import static java.util.Arrays.asList;
import static java.util.Collections.unmodifiableList;
import static java.util.Collections.unmodifiableSet;
import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Optional;
import java.util.OptionalInt;
import java.util.Set;
import de.larssh.utils.OptionalInts;
import de.larssh.utils.text.Strings;

/**
 * Value object containing a jobs status information. Depending on the objects
 * creating code not all fields are present.
 *
 * &lt;p&gt;
 * Two {@code Job} objects are equal if their IDs are equal. Therefore two
 * objects with the same ID, but different job status (e.g. one older and one
 * up-to-date object) are still equal!
 */
@SuppressWarnings({&quot;PMD.DataClass&quot;, &quot;PMD.ShortClassName&quot;})
public class Job {
	/**
	 * The jobs ID, must not be empty
	 */
	@SuppressWarnings(&quot;PMD.ShortVariable&quot;)
	private final String id;
	/**
	 * The jobs name
	 *
	 * &lt;p&gt;
	 * Depending on the objects creating code this might be a filter value,
	 * eventually containing {@link JesClient#FILTER_WILDCARD}.
	 */
	private final String name;
	/**
	 * The jobs status
	 */
	private final JobStatus status;
	/**
	 * The jobs owner
	 *
	 * &lt;p&gt;
	 * Depending on the objects creating code this might be a filter value,
	 * eventually containing {@link JesClient#FILTER_WILDCARD}.
	 */
	private final String owner;
	/**
	 * The jobs JES spool class
	 */
	private final Optional&lt;String&gt; jesClass;
	/**
	 * The jobs result code
	 *
	 * &lt;p&gt;
	 * This field can be present for {@link JobStatus#OUTPUT} (and
	 * {@link JobStatus#ALL}) only. It cannot be present as long as
	 * {@code abendCode} is present.
	 */
	private final OptionalInt resultCode;
	/**
	 * The jobs abend code
	 *
	 * &lt;p&gt;
	 * This field can be present for {@link JobStatus#OUTPUT} (and
	 * {@link JobStatus#ALL}) only. It cannot be present as long as
	 * {@code resultCode} is present.
	 */
	private final Optional&lt;String&gt; abendCode;
	/**
	 * The jobs flags
	 */
	private final Set&lt;JobFlag&gt; flags;
	/**
	 * List of job output details
	 *
	 * &lt;p&gt;
	 * Can be filled by
	 * {@link #createOutput(int, String, int, Optional, Optional, Optional)} and
	 * must be empty for status other than {@link JobStatus#OUTPUT} (and
	 * {@link JobStatus#ALL}).
	 *
	 * @return list of job outputs
	 */
<span class="fc" id="L89">	private final List&lt;JobOutput&gt; outputs = new ArrayList&lt;&gt;();</span>

	/**
	 * This constructor creates a {@link Job} in its simplest form. String
	 * parameters are trimmed and converted to upper case.
	 *
	 * @param jobId  the jobs ID, must not be empty
	 * @param name   the jobs name or a name filter value
	 * @param status the jobs status or {@link JobStatus#ALL}
	 * @param owner  the jobs owner or an owner filter value
	 * @throws JobFieldInconsistentException on inconsistent field value
	 */
	public Job(final String jobId, final String name, final JobStatus status, final String owner) {
<span class="fc" id="L102">		this(jobId, name, status, owner, Optional.empty(), OptionalInt.empty(), Optional.empty());</span>
<span class="fc" id="L103">	}</span>

	/**
	 * This constructor creates a {@link Job} allowing to set any field. String
	 * parameters are trimmed and converted to upper case.
	 *
	 * @param jobId      the jobs ID, must not be empty
	 * @param name       the jobs name or a name filter value
	 * @param status     the jobs status or {@link JobStatus#ALL}
	 * @param owner      the jobs owner or an owner filter value
	 * @param jesClass   the jobs JES class
	 * @param resultCode the jobs result code, when held (finished)
	 * @param abendCode  the jobs abend code, when held (finished)
	 * @param flags      the jobs flags
	 * @throws JobFieldInconsistentException on inconsistent field value
	 */
	@SuppressWarnings(&quot;checkstyle:ParameterNumber&quot;)
<span class="fc" id="L120">	public Job(final String jobId, final String name, final JobStatus status, final String owner, final Optional&lt;String&gt; jesClass, final OptionalInt resultCode, final Optional&lt;String&gt; abendCode, final JobFlag... flags) {</span>
<span class="fc" id="L121">		id = Strings.toUpperCaseNeutral(jobId.trim());</span>
<span class="fc" id="L122">		this.name = Strings.toUpperCaseNeutral(name.trim());</span>
<span class="fc" id="L123">		this.status = status;</span>
<span class="fc" id="L124">		this.owner = Strings.toUpperCaseNeutral(owner.trim());</span>
<span class="fc" id="L125">		this.jesClass = jesClass.map(String::trim).map(Strings::toUpperCaseNeutral);</span>
<span class="fc" id="L126">		this.abendCode = abendCode.map(String::trim).map(Strings::toUpperCaseNeutral);</span>
<span class="fc" id="L127">		this.resultCode = resultCode;</span>
<span class="fc" id="L128">		this.flags = unmodifiableSet(new HashSet&lt;&gt;(asList(flags)));</span>
<span class="fc" id="L129">		validate();</span>
<span class="fc" id="L130">	}</span>

	/**
	 * Creates a {@link JobOutput} and adds it to the list of job outputs. Creating
	 * of job outputs for status other than {@link JobStatus#OUTPUT} (and
	 * {@link JobStatus#ALL}) is prohibited. String parameters are trimmed and
	 * converted to upper case.
	 *
	 * @param index         the job outputs index inside the jobs list of outputs
	 *                      (starting at 1)
	 * @param outputName    the job outputs data division name
	 * @param length        the job outputs content length
	 * @param step          the job outputs step name
	 * @param procedureStep the job outputs procedure step name
	 * @param outputClass   the output class
	 * @return created job output
	 * @throws JobFieldInconsistentException on inconsistent field value
	 */
	public JobOutput createOutput(final int index, final String outputName, final int length, final Optional&lt;String&gt; step, final Optional&lt;String&gt; procedureStep, final Optional&lt;String&gt; outputClass) {
<span class="fc bfc" id="L149" title="All 4 branches covered.">		if (getStatus() != JobStatus.OUTPUT &amp;&amp; getStatus() != JobStatus.ALL) {</span>
<span class="fc" id="L150">			throw new JobFieldInconsistentException(&quot;Job outputs for status other than OUTPUT (and ALL) cannot be created. Status: %s&quot;, getStatus());</span>
		}
<span class="fc" id="L152">		final JobOutput output = new JobOutput(this, index, outputName, length, step, procedureStep, outputClass);</span>
<span class="fc" id="L153">		outputs.add(output);</span>
<span class="fc" id="L154">		return output;</span>
	}

	/**
	 * Returns the job output details referenced by {@code name} or
	 * {@link Optional#empty()} if no such job output exists.
	 *
	 * @param name job output name to search for
	 * @return job output details referenced by {@code name} or
	 *         {@link Optional#empty()} if no such job output exists
	 */
	public Optional&lt;JobOutput&gt; getOutput(final String name) {
<span class="fc" id="L166">		final String trimmedName = name.trim();</span>
<span class="fc" id="L167">		return getOutputs().stream().filter(output -&gt; output.getName().equalsIgnoreCase(trimmedName)).findFirst();</span>
	}

	/**
	 * List of job output details
	 *
	 * &lt;p&gt;
	 * Can be filled by
	 * {@link #createOutput(int, String, int, Optional, Optional, Optional)} and
	 * must be empty for status other than {@link JobStatus#OUTPUT} (and
	 * {@link JobStatus#ALL}).
	 *
	 * @return list of job output details
	 */
	public List&lt;JobOutput&gt; getOutputs() {
<span class="fc" id="L182">		return unmodifiableList(outputs);</span>
	}

	/**
	 * Validates fields to be set in a consistent way.
	 *
	 * @throws JobFieldInconsistentException on inconsistent field value
	 */
	@SuppressWarnings({&quot;PMD.CyclomaticComplexity&quot;, &quot;PMD.NPathComplexity&quot;})
	private void validate() {
<span class="fc bfc" id="L192" title="All 2 branches covered.">		if (id.isEmpty()) {</span>
<span class="fc" id="L193">			throw new JobFieldInconsistentException(&quot;Job ID must be filled, but is empty.&quot;);</span>
		}
<span class="fc bfc" id="L195" title="All 2 branches covered.">		if (jesClass.filter(String::isEmpty).isPresent()) {</span>
<span class="fc" id="L196">			throw new JobFieldInconsistentException(&quot;JES class must not be empty if present.&quot;);</span>
		}
<span class="fc bfc" id="L198" title="All 4 branches covered.">		if (resultCode.isPresent() &amp;&amp; abendCode.isPresent()) {</span>
<span class="fc" id="L199">			throw new JobFieldInconsistentException(&quot;Result Code and Abend Code must not be present at the same time.&quot;);</span>
		}
<span class="fc bfc" id="L201" title="All 4 branches covered.">		if (OptionalInts.filter(resultCode, r -&gt; r &lt; 0).isPresent()) {</span>
<span class="fc" id="L202">			throw new JobFieldInconsistentException(&quot;Result Code must not be less than zero.&quot;);</span>
		}
<span class="fc bfc" id="L204" title="All 2 branches covered.">		if (abendCode.filter(String::isEmpty).isPresent()) {</span>
<span class="fc" id="L205">			throw new JobFieldInconsistentException(&quot;Abend Code must not be empty if present.&quot;);</span>
		}
<span class="fc bfc" id="L207" title="All 4 branches covered.">		if (status != JobStatus.OUTPUT &amp;&amp; status != JobStatus.ALL) {</span>
<span class="fc bfc" id="L208" title="All 2 branches covered.">			if (resultCode.isPresent()) {</span>
<span class="fc" id="L209">				throw new JobFieldInconsistentException(Strings.format(&quot;Result Code must not be present for status [%s].&quot;, status));</span>
			}
<span class="fc bfc" id="L211" title="All 2 branches covered.">			if (abendCode.isPresent()) {</span>
<span class="fc" id="L212">				throw new JobFieldInconsistentException(Strings.format(&quot;Abend Code must not be present for status [%s].&quot;, status));</span>
			}
		}
<span class="fc" id="L215">	}</span>

	/**
	 * The jobs ID, must not be empty
	 *
	 * @return job id
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public String getId() {
		return this.id;
	}

	/**
	 * The jobs name
	 *
	 * &lt;p&gt;
	 * Depending on the objects creating code this might be a filter value,
	 * eventually containing {@link JesClient#FILTER_WILDCARD}.
	 *
	 * @return job name
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public String getName() {
		return this.name;
	}

	/**
	 * The jobs status
	 *
	 * @return job status
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public JobStatus getStatus() {
		return this.status;
	}

	/**
	 * The jobs owner
	 *
	 * &lt;p&gt;
	 * Depending on the objects creating code this might be a filter value,
	 * eventually containing {@link JesClient#FILTER_WILDCARD}.
	 *
	 * @return job owner
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public String getOwner() {
		return this.owner;
	}

	/**
	 * The jobs JES spool class
	 *
	 * @return job class
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public Optional&lt;String&gt; getJesClass() {
		return this.jesClass;
	}

	/**
	 * The jobs result code
	 *
	 * &lt;p&gt;
	 * This field can be present for {@link JobStatus#OUTPUT} (and
	 * {@link JobStatus#ALL}) only. It cannot be present as long as
	 * {@code abendCode} is present.
	 *
	 * @return result code
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public OptionalInt getResultCode() {
		return this.resultCode;
	}

	/**
	 * The jobs abend code
	 *
	 * &lt;p&gt;
	 * This field can be present for {@link JobStatus#OUTPUT} (and
	 * {@link JobStatus#ALL}) only. It cannot be present as long as
	 * {@code resultCode} is present.
	 *
	 * @return abend code
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public Optional&lt;String&gt; getAbendCode() {
		return this.abendCode;
	}

	/**
	 * The jobs flags
	 *
	 * @return flags
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public Set&lt;JobFlag&gt; getFlags() {
		return this.flags;
	}

	@edu.umd.cs.findbugs.annotations.NonNull
	@java.lang.Override
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public java.lang.String toString() {
		return &quot;Job(id=&quot; + this.getId() + &quot;, name=&quot; + this.getName() + &quot;, status=&quot; + this.getStatus() + &quot;, owner=&quot; + this.getOwner() + &quot;, jesClass=&quot; + this.getJesClass() + &quot;, resultCode=&quot; + this.getResultCode() + &quot;, abendCode=&quot; + this.getAbendCode() + &quot;, flags=&quot; + this.getFlags() + &quot;, outputs=&quot; + this.getOutputs() + &quot;)&quot;;
	}

	@java.lang.Override
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public boolean equals(@edu.umd.cs.findbugs.annotations.Nullable final java.lang.Object o) {
		if (o == this) return true;
		if (!(o instanceof Job)) return false;
		final Job other = (Job) o;
		if (!other.canEqual((java.lang.Object) this)) return false;
		final java.lang.Object this$id = this.getId();
		final java.lang.Object other$id = other.getId();
		if (this$id == null ? other$id != null : !this$id.equals(other$id)) return false;
		return true;
	}

	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	protected boolean canEqual(@edu.umd.cs.findbugs.annotations.Nullable final java.lang.Object other) {
		return other instanceof Job;
	}

	@java.lang.Override
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public int hashCode() {
		final int PRIME = 59;
		int result = 1;
		final java.lang.Object $id = this.getId();
		result = result * PRIME + ($id == null ? 43 : $id.hashCode());
		return result;
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>